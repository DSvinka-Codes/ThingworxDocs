---
cover: ../.gitbook/assets/Banner_LogicOpertor.jpg
coverY: 0
layout:
  cover:
    visible: true
    size: full
  title:
    visible: true
  description:
    visible: true
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Операторы Математические

## Термины: «унарный», «бинарный», «операнд»

Прежде, чем мы двинемся дальше, давайте разберёмся с терминологией.

* **Операнд** – то, к чему применяется оператор. Например, в умножении `5 * 2` есть два операнда: левый операнд равен `5`, а правый операнд равен `2`. Иногда их называют «аргументами» вместо «операндов».
*   **Унарным** называется оператор, который применяется к одному операнду. Например, оператор унарный минус `"-"` меняет знак числа на противоположный:

    ```javascript
    me.x = 1;

    me.x = -me.x; // -1
    ```
*   **Бинарным** называется оператор, который применяется к двум операндам. Тот же минус существует и в бинарной форме:

    ```javascript
    me.x = 1; 
    me.y = 3;
    me.numberResult = y - x; // 2, бинарный минус вычитает значения
    ```

    Формально, в последних примерах мы говорим о двух разных операторах, использующих один символ: оператор отрицания (унарный оператор, который обращает знак) и оператор вычитания (бинарный оператор, который вычитает одно число из другого).

## Математика

Поддерживаются следующие математические операторы:

* Сложение `+`,
* Вычитание `-`,
* Умножение `*`,
* Деление `/`,
* Взятие остатка от деления `%`,
* Возведение в степень `**`.

Первые четыре оператора очевидны, а про `%` и `**` стоит сказать несколько слов.

### Взятие остатка %

Оператор взятия остатка `%`, несмотря на обозначение, никакого отношения к процентам не имеет.

Результат `a % b` – это остаток от целочисленного деления `a` на `b`.

Например:

```javascript
me.numberResult = 5 % 2; // 1, остаток от деления 5 на 2
me.numberResult = 8 % 3; // 2, остаток от деления 8 на 3
me.numberResult = 8 % 4; // 0, остаток от деления 8 на 4
```

### Возведение в степень \*\*

Оператор возведения в степень `a ** b` возводит `a` в степень `b`.

В школьной математике мы записываем это как ab.

Например:

```javascript
me.numberResult = 2 ** 2; // 2² = 4
me.numberResult = 2 ** 3; // 2³ = 8
me.numberResult = 2 ** 4; // 2⁴ = 16
```

Математически, оператор работает и для нецелых чисел. Например, квадратный корень является возведением в степень ½:

```javascript
me.numberResult = 4 ** (1/2); 
// 2 (степень 1/2 эквивалентна взятию квадратного корня)
```

## Сложение строк при помощи бинарного +

Давайте рассмотрим специальные возможности операторов JavaScript, которые выходят за рамки школьной арифметики.

Обычно при помощи плюса `'+'` складывают числа.

Но если бинарный оператор `'+'` применить к строкам, то он их объединяет в одну:

```javascript
me.stringResult = "моя" + "строка"; // моястрока
```

Обратите внимание, если хотя бы один операнд является строкой, то второй будет также преобразован в строку.

Например:

```javascript
me.stringResult = '1' + 2; // "12"
me.stringResult = 2 + '1'; // "21"
```

Как видите, не важно, первый или второй операнд является строкой.

Вот пример посложнее:

```javascript
me.stringResult = 2 + 2 + '1'; // будет "41", а не "221"
```

Здесь операторы работают один за другим. Первый `+` складывает два числа и возвращает `4`, затем следующий `+` объединяет результат со строкой, производя действие `4 + '1' = '41'`.

Сложение и преобразование строк — это особенность бинарного плюса `+`. Другие арифметические операторы работают только с числами и всегда преобразуют операнды в числа.

Например, вычитание и деление:

```javascript
me.numberResult = 6 - '2'; // 4, '2' приводится к числу
me.numberResult = '6' / '2'; // 3, оба операнда приводятся к числам
```

## Приведение к числу, унарный +

Плюс `+` существует в двух формах: бинарной, которую мы использовали выше, и унарной.

Унарный, то есть применённый к одному значению, плюс `+` ничего не делает с числами. Но если операнд не число, унарный плюс преобразует его в число.

Например:

```javascript
// Не влияет на числа
me.x = 1;
me.numberResult = +me.x; // 1

me.y = -2;
me.numberResult = +me.y; // -2

// Преобразует не числа в числа
me.numberResult = +true; // 1
me.x+"";   // 0
```

На самом деле это то же самое, что и `Number(...)`, только короче.

Необходимость преобразовывать строки в числа возникает очень часто. Например, обычно значения Параметров Мониторинга вещей - это строки. А что, если их нужно, к примеру, сложить?

Бинарный плюс сложит их как строки:

```javascript
me.x = "2";
me.y = "3";

me.stringResult = me.x + me.y; // "23", так как бинарный плюс объединяет строки
```

Поэтому используем унарный плюс, чтобы преобразовать к числу:

```javascript
me.x = "2";
me.y = "3";

// оба операнда предварительно преобразованы в числа
me.numberResult = +me.x + +me.y; // 5

// тоже самое, но более длинный вариант
// me.numberResult = Number(me.x) + Number(me.y); // 5
```

С точки зрения математика, такое изобилие плюсов выглядит странным. Но с точки зрения программиста тут нет ничего особенного: сначала выполнятся унарные плюсы, которые приведут строки к числам, а затем бинарный `'+'` их сложит.

Почему унарные плюсы выполнились до бинарного сложения? \
Как мы сейчас увидим, дело в их приоритете.

## Приоритет операторов

В том случае, если в выражении есть несколько операторов – порядок их выполнения определяется _приоритетом_, или, другими словами, существует определённый порядок выполнения операторов.

Из школы мы знаем, что умножение в выражении `1 + 2 * 2` выполнится раньше сложения. Это как раз и есть «приоритет». Говорят, что умножение имеет более высокий приоритет, чем сложение.

Скобки важнее, чем приоритет, так что, если мы не удовлетворены порядком по умолчанию, мы можем использовать их, чтобы изменить приоритет. Например, написать `(1 + 2) * 2`.

В JavaScript много операторов. Каждый оператор имеет соответствующий номер приоритета. Тот, у кого это число больше, – выполнится раньше. Если приоритет одинаковый, то порядок выполнения – слева направо.

Отрывок из [таблицы приоритетов](https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Operators/Operator\_Precedence) (нет необходимости всё запоминать, обратите внимание, что приоритет унарных операторов выше, чем соответствующих бинарных):

| Приоритет | Название             | Обозначение |
| --------- | -------------------- | ----------- |
| …         | …                    | …           |
| 15        | унарный плюс         | `+`         |
| 15        | унарный минус        | `-`         |
| 14        | возведение в степень | `**`        |
| 13        | умножение            | `*`         |
| 13        | деление              | `/`         |
| 12        | сложение             | `+`         |
| 12        | вычитание            | `-`         |
| …         | …                    | …           |
| 2         | присваивание         | `=`         |
| …         | …                    | …           |

Так как «унарный плюс» имеет приоритет `15`, который выше, чем `12` у «сложения» (бинарный плюс), то в выражении `"+me.x + +me.y"` сначала выполнятся унарные плюсы, а затем сложение.

## Присваивание

Давайте отметим, что в таблице приоритетов также есть оператор присваивания `=`. У него один из самых низких приоритетов: `2`.

Именно поэтому, когда переменной что-либо присваивают, например, `x = 2 * 2 + 1`, то сначала выполнится арифметика, а уже затем произойдёт присваивание `=` с сохранением результата в `x`.

```javascript
me.numberResult = 2 * 2 + 1; // 5
```

### Присваивание по цепочке

Рассмотрим одну интересную возможность: цепочку присваиваний.

```javascript
me.a = me.b = me.c = 2 + 2;

// me.a; == 4
// me.b; == 4
// me.c; == 4
```

Такое присваивание работает справа налево. Сначала вычисляется самое правое выражение `2 + 2`, и затем результат присваивается переменным слева: `c`, `b` и `a`. В конце у всех переменных будет одно значение.

Опять-таки, чтобы код читался легче, лучше разделять подобные конструкции на несколько строчек:

<pre class="language-javascript"><code class="lang-javascript">me.c = 2 + 2;
<strong>me.b = me.c;
</strong>me.a = me.c;
</code></pre>

Польза от такого стиля особенно ощущается при быстром просмотре кода.

## Сокращённая арифметика с присваиванием

Часто нужно применить оператор к переменной и сохранить результат в ней же.

Например:

```javascript
me.n = 2;
me.n = me.n + 5;
me.n = me.n * 2;
```

Эту запись можно укоротить при помощи совмещённых операторов `+=` и `*=`:

```javascript
me.n = 2;
me.n += 5; // теперь me.n = 7 (работает как n = n + 5)
me.n *= 2; // теперь me.n = 14 (работает как n = n * 2)
```

Подобные краткие формы записи существуют для **всех** арифметических и побитовых операторов: `/=`, `-=`, `**=` и так далее.

Вызов с присваиванием имеет в точности такой же приоритет, как обычное присваивание, то есть выполнится после большинства других операций:

<pre class="language-javascript"><code class="lang-javascript">me.n = 2;

<strong>me.n *= 3 + 5; // 16  (сначала выполнится правая часть, выражение идентично n *= 8)
</strong></code></pre>

## Инкремент/декремент

Одной из наиболее частых числовых операций является увеличение или уменьшение на единицу.

Для этого существуют даже специальные операторы:

*   **Инкремент** `++` увеличивает переменную на 1:

    ```javascript
    me.counter = 2;
    me.counter++;        
    // работает как counter = counter + 1, просто запись короче
    // me.counter == 3
    ```
*   **Декремент** `--` уменьшает переменную на 1:

    ```javascript
    me.counter = 2;
    me.counter--;        
    // работает как counter = counter - 1, просто запись короче
    // me.counter == 1
    ```

{% hint style="danger" %}
**Важно:**

Инкремент/декремент можно применить только к переменной. Попытка использовать его на значении, типа `5++`, приведёт к ошибке.
{% endhint %}

Операторы `++` и `--` могут быть расположены не только после, но и до переменной.

* Когда оператор идёт после переменной — это «постфиксная форма»: `counter++`.
* «Префиксная форма» — это когда оператор идёт перед переменной: `++counter`.

Обе эти инструкции делают одно и то же: увеличивают `counter` на `1`.

Есть ли разница между ними? \
Да, но увидеть её мы сможем, только если будем использовать значение, которое возвращают `++/--`.

Давайте проясним этот момент. Как мы знаем, все операторы возвращают значение. Операторы инкремента/декремента не исключение. Префиксная форма возвращает новое значение, в то время как постфиксная форма возвращает старое (до увеличения/уменьшения числа).

Чтобы увидеть разницу, вот небольшой пример:

```javascript
me.counter = 1;
me.a = ++counter; // (*)

// me.a == 2
```

В строке `(*)` _префиксная_ форма `++counter` увеличивает `counter` и возвращает новое значение `2`. Так что в Property `me.a` запишется `2`.

Теперь посмотрим на постфиксную форму:

```javascript
me.counter = 1;
me.a = counter++; // (*) меняем ++counter на counter++

// me.a == 1
```

В строке `(*)` _постфиксная_ форма `counter++` также увеличивает `counter`, но возвращает _старое_ значение (которое было до увеличения). Так что в `me.a` запишется `1`.

Подведём итоги:

*   Если результат оператора не используется, а нужно только увеличить/уменьшить переменную, тогда без разницы, какую форму использовать:

    ```javascript
    me.counter = 0;
    me.counter++;
    ++me.counter;
    // me.counter == 2, обе строки сделали одно и то же
    ```
*   Если хочется тут же использовать результат, то нужна префиксная форма:

    ```javascript
    me.counter = 0;
    me.c = ++me.counter; // 1
    ```
*   Если нужно увеличить и при этом получить значение переменной _до увеличения_ – нужна постфиксная форма:

    ```javascript
    me.counter = 0;
    me.c = me.counter++; 
    // me.c == 0
    // Но me.counter теперь 1
    ```



{% hint style="info" %}


**Инкремент/декремент можно использовать в любых выражениях**

Операторы `++/--` могут также использоваться внутри выражений. Их приоритет выше, чем у большинства других арифметических операций.

Например:

{% code lineNumbers="true" %}
```javascript
me.counter = 1;
me.c = 2 * ++me.counter; 
// me.c == 4
```
{% endcode %}

Сравните с:

{% code lineNumbers="true" fullWidth="false" %}
```javascript
me.counter = 1;
me.c = 2 * me.counter++; 
// me.c == 2, потому что counter++ возвращает "старое" значение
```
{% endcode %}

Хотя технически здесь всё в порядке, такая запись обычно делает код менее читабельным. Одна строка выполняет множество действий – нехорошо.

При беглом чтении кода можно с лёгкостью пропустить такой `counter++`, и будет неочевидно, что переменная увеличивается.

Лучше использовать стиль «одна строка – одно действие»:

{% code lineNumbers="true" %}
```javascript
me.counter = 1;
me.c = 2 * me.counter;
counter++;
```
{% endcode %}
{% endhint %}

